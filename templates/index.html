{% extends "base.html" %}

{% block title %}Home - Majesty Xpress Logistics{% endblock %}

{% block content %}
<style>
    /* Mobile-First CSS Variables */
    :root {
        --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --primary-light: rgba(102, 126, 234, 0.1);
        --primary-dark: #5a6fd8;
        --text-dark: #1a202c;
        --text-medium: #4a5568;
        --text-light: #718096;
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.15);
        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.2);
        --glass-bg: rgba(255, 255, 255, 0.98);
        --glass-border: rgba(255, 255, 255, 0.3);
        --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --border-radius-lg: 16px;
        --border-radius-md: 12px;
        --border-radius-sm: 8px;
        --safe-area-left: env(safe-area-inset-left, 0px);
        --safe-area-right: env(safe-area-inset-right, 0px);
    }

    /* Reset for mobile */
    * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
    }

    /* Hero Section - Mobile Optimized */
    .hero {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-radius: var(--border-radius-lg);
        padding: clamp(1.5rem, 5vw, 3rem);
        margin: 0.75rem 0 2.5rem;
        text-align: center;
        box-shadow: var(--shadow-md);
        border: 1px solid var(--glass-border);
        position: relative;
        overflow: hidden;
    }

    .hero-content {
        position: relative;
        z-index: 1;
    }

    .hero h1 {
        font-size: clamp(1.75rem, 6vw, 3rem);
        margin-bottom: 1rem;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
        line-height: 1.2;
        letter-spacing: -0.02em;
    }

    .hero p {
        font-size: clamp(0.95rem, 3vw, 1.125rem);
        color: var(--text-medium);
        max-width: 42rem;
        margin: 0 auto 2rem;
        line-height: 1.6;
        font-weight: 400;
    }

    /* CTA Buttons - Mobile Responsive */
    .cta-buttons {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        align-items: stretch;
        max-width: 28rem;
        margin: 0 auto;
    }

    @media (min-width: 640px) {
        .cta-buttons {
            flex-direction: row;
            justify-content: center;
            align-items: center;
        }
    }

    .btn {
        padding: 0.875rem 1.5rem;
        border-radius: var(--border-radius-md);
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9375rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        transition: var(--transition-smooth);
        text-align: center;
        border: 2px solid transparent;
        cursor: pointer;
        min-height: 3rem;
        width: 100%;
    }

    @media (min-width: 640px) {
        .btn {
            width: auto;
            min-width: 10rem;
        }
    }

    .btn-primary {
        background: var(--primary-gradient);
        color: white;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .btn-primary:hover, 
    .btn-primary:active {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
        background: white;
        color: #667eea;
        border-color: rgba(102, 126, 234, 0.3);
        box-shadow: var(--shadow-sm);
    }

    .btn-secondary:hover,
    .btn-secondary:active {
        background: rgba(102, 126, 234, 0.05);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }

    /* Tracking Section - Mobile Optimized */
    .tracking-section {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border-radius: var(--border-radius-lg);
        padding: 1.5rem;
        margin: 0 0 3rem;
        box-shadow: var(--shadow-md);
        border: 1px solid var(--glass-border);
    }

    .tracking-section h2 {
        font-size: clamp(1.25rem, 4vw, 1.75rem);
        margin-bottom: 0.5rem;
        text-align: center;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 700;
    }

    .tracking-section > p {
        text-align: center;
        color: var(--text-light);
        font-size: 0.9375rem;
        margin-bottom: 1.5rem;
    }

    .tracking-form {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    @media (min-width: 640px) {
        .tracking-form {
            flex-direction: row;
            align-items: center;
        }
    }

    .tracking-input {
        flex: 1;
        padding: 0.875rem 1rem;
        border: 2px solid rgba(102, 126, 234, 0.2);
        border-radius: var(--border-radius-md);
        font-size: 0.9375rem;
        background: white;
        color: var(--text-dark);
        transition: var(--transition-smooth);
        min-width: 0;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
    }

    .tracking-input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .tracking-input::placeholder {
        color: #a0aec0;
    }

    .tracking-btn {
        padding: 0.875rem 1.5rem;
        background: var(--primary-gradient);
        color: white;
        border: none;
        border-radius: var(--border-radius-md);
        font-weight: 600;
        font-size: 0.9375rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        transition: var(--transition-smooth);
        min-height: 3rem;
        white-space: nowrap;
    }

    .tracking-btn:hover,
    .tracking-btn:active {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    /* Section Titles */
    .section-title {
        text-align: center;
        margin-bottom: 2rem;
        padding: 0 1rem;
    }

    .section-title h2 {
        font-size: clamp(1.5rem, 4vw, 2rem);
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        background-clip: text;
        font-weight: 700;
        margin-bottom: 0.5rem;
        line-height: 1.2;
    }

    .section-title p {
        color: var(--glass-bg);
        font-size: 0.9375rem;
        max-width: 36rem;
        margin: 0 auto;
    }

    /* Features Grid - Mobile Responsive */
    .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(min(100%, 300px), 1fr));
        gap: 1.25rem;
        margin-bottom: 3rem;
    }

    .feature-card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        padding: 1.5rem;
        border-radius: var(--border-radius-lg);
        text-align: center;
        box-shadow: var(--shadow-sm);
        transition: var(--transition-smooth);
        border: 1px solid var(--glass-border);
    }

    .feature-card:hover,
    .feature-card:active {
        transform: translateY(-4px);
        box-shadow: var(--shadow-md);
    }

    .feature-icon {
        width: 4rem;
        height: 4rem;
        margin: 0 auto 1rem;
        background: var(--primary-gradient);
        border-radius: var(--border-radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.25);
    }

    .feature-card h3 {
        font-size: 1.125rem;
        color: var(--text-dark);
        margin-bottom: 0.5rem;
        font-weight: 600;
    }

    .feature-card p {
        color: var(--text-light);
        font-size: 0.875rem;
        line-height: 1.5;
    }

    /* Stats Section - Mobile Responsive */
    .stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin-bottom: 3rem;
    }

    @media (min-width: 768px) {
        .stats {
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
        }
    }

    .stat-card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        padding: 1.25rem;
        border-radius: var(--border-radius-lg);
        text-align: center;
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--glass-border);
    }

    .stat-number {
        font-size: clamp(1.5rem, 4vw, 2.5rem);
        font-weight: 800;
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.25rem;
        line-height: 1;
    }

    .stat-label {
        color: var(--text-medium);
        font-size: 0.8125rem;
        font-weight: 500;
    }

    /* CTA Section - Mobile Optimized */
    .cta-section {
        background: rgba(102, 126, 234, 0.05);
        border-radius: var(--border-radius-lg);
        padding: 2rem 1.5rem;
        text-align: center;
        border: 1px solid rgba(102, 126, 234, 0.1);
        margin-bottom: 2rem;
    }

    .cta-section h2 {
        font-size: clamp(1.25rem, 4vw, 1.75rem);
        margin-bottom: 0.75rem;
        background: var(--glass-bg);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 700;
        line-height: 1.2;
    }

    .cta-section p {
        color: var(--glass-bg);
        font-size: 0.9375rem;
        max-width: 36rem;
        margin: 0 auto 1.5rem;
        line-height: 1.6;
    }

    /* Mobile-Specific Optimizations */
    @media (max-width: 640px) {
        .hero {
            margin: 0.5rem 0 2rem;
            padding: 1.25rem;
        }

        .tracking-section {
            padding: 1.25rem;
            margin-bottom: 2.5rem;
        }

        .features {
            gap: 1rem;
        }

        .feature-card {
            padding: 1.25rem;
        }

        .stats {
            gap: 0.75rem;
        }

        .stat-card {
            padding: 1rem;
        }

        .cta-section {
            padding: 1.5rem;
        }
    }

    @media (max-width: 480px) {
        .hero h1 {
            font-size: 1.5rem;
        }

        .hero p {
            font-size: 0.875rem;
        }

        .btn {
            padding: 0.75rem 1.25rem;
            font-size: 0.875rem;
        }

        .feature-icon {
            width: 3.5rem;
            height: 3.5rem;
            font-size: 1.25rem;
        }

        .stat-number {
            font-size: 1.25rem;
        }
    }

    /* Touch Device Optimizations */
    @media (hover: none) and (pointer: coarse) {
        .btn:hover,
        .feature-card:hover,
        .stat-card:hover,
        .tracking-btn:hover {
            transform: none;
        }

        .btn:active,
        .feature-card:active,
        .stat-card:active,
        .tracking-btn:active {
            transform: scale(0.98);
        }

        .btn-primary:active {
            opacity: 0.9;
        }

        .btn-secondary:active {
            background: rgba(102, 126, 234, 0.1);
        }

        /* Increase touch target sizes */
        .btn,
        .tracking-btn,
        .tracking-input {
            min-height: 3.25rem;
        }
    }

    /* Safe Area Support for Notched Phones */
    @supports (padding: max(0px)) {
        .hero,
        .tracking-section,
        .cta-section {
            padding-left: max(1rem, var(--safe-area-left));
            padding-right: max(1rem, var(--safe-area-right));
        }
    }

    /* Reduced Motion Support */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }

        .hero,
        .feature-card,
        .stat-card {
            animation: none !important;
        }
    }

    /* Dark Mode Support */
    @media (prefers-color-scheme: dark) {
        :root {
            --glass-bg: rgba(26, 32, 44, 0.95);
            --glass-border: rgba(45, 55, 72, 0.5);
            --text-dark: #e2e8f0;
            --text-medium: #cbd5e0;
            --text-light: #a0aec0;
        }

        .tracking-input {
            background: rgba(45, 55, 72, 0.7);
            color: #e2e8f0;
            border-color: rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: rgba(45, 55, 72, 0.7);
            color: #a3bffa;
            border-color: rgba(102, 126, 234, 0.3);
        }

        .cta-section {
            background: rgba(102, 126, 234, 0.1);
        }
    }

    /* Print Styles */
    @media print {
        .hero,
        .tracking-section,
        .features,
        .stats,
        .cta-section {
            box-shadow: none !important;
            border: 1px solid #ddd !important;
            background: white !important;
            color: black !important;
        }

        .btn,
        .tracking-btn {
            border: 1px solid #333 !important;
            background: white !important;
            color: black !important;
        }
    }

    /* Fix for mobile scrolling */
    html, body {
        overflow-x: hidden;
        width: 100%;
        position: relative;
        -webkit-overflow-scrolling: touch;
    }

    /* Ensure content is scrollable */
    main {
        overflow: visible;
        position: relative;
    }
</style>

<!-- Hero Section -->
<section class="hero">
    <div class="hero-content">
        <h1>Fast & Reliable Logistics Solutions</h1>
        <p>Delivering your packages with care and precision. Track shipments in real-time and experience seamless delivery services across the globe.</p>
        <div class="cta-buttons">
            <a href="{{ url_for('book_delivery') }}" class="btn btn-primary" aria-label="Book a delivery service">
                <i class="fas fa-rocket" aria-hidden="true"></i>
                <span>Book Delivery</span>
            </a>
            <a href="{{ url_for('services') }}" class="btn btn-secondary" aria-label="View our services">
                <i class="fas fa-concierge-bell" aria-hidden="true"></i>
                <span>View Services</span>
            </a>
        </div>
    </div>
</section>

<!-- Tracking Section -->
<div class="tracking-section">
    <h2>Track Your Shipment</h2>
    <p>Enter your tracking number to check the status of your delivery</p>
    
    <form action="{{ url_for('track_delivery_page') }}" method="GET" class="tracking-form" role="search">
        <input 
            type="text" 
            name="tracking_number" 
            placeholder="Enter tracking number (e.g., TRK-XXXXXX)" 
            class="tracking-input"
            required
            aria-label="Tracking number"
            autocapitalize="off"
            autocorrect="off"
            spellcheck="false"
        >
        <button type="submit" class="tracking-btn" aria-label="Track shipment">
            <i class="fas fa-search" aria-hidden="true"></i>
            <span>Track Now</span>
        </button>
    </form>
</div>

<!-- Features Section -->
<div class="section-title">
    <h2>Why Choose Majesty Xpress</h2>
    <p>Experience the difference with our premium logistics services</p>
</div>

<div class="features">
    <div class="feature-card">
        <div class="feature-icon" aria-hidden="true">
            <i class="fas fa-bolt"></i>
        </div>
        <h3>Lightning Fast</h3>
        <p>Express delivery with same-day shipping in major cities worldwide.</p>
    </div>
    
    <div class="feature-card">
        <div class="feature-icon" aria-hidden="true">
            <i class="fas fa-shield-alt"></i>
        </div>
        <h3>Secure & Insured</h3>
        <p>Every package fully insured with premium care and security.</p>
    </div>
    
    <div class="feature-card">
        <div class="feature-icon" aria-hidden="true">
            <i class="fas fa-globe-americas"></i>
        </div>
        <h3>Global Coverage</h3>
        <p>Nationwide and international shipping to over 180 countries.</p>
    </div>
    
    <div class="feature-card">
        <div class="feature-icon" aria-hidden="true">
            <i class="fas fa-headset"></i>
        </div>
        <h3>24/7 Support</h3>
        <p>Round-the-clock customer support for all your questions.</p>
    </div>
</div>

<!-- Stats Section -->
<div class="section-title">
    <h2>Our Impact in Numbers</h2>
    <p>Join thousands of satisfied customers worldwide</p>
</div>

<div class="stats">
    <div class="stat-card">
        <div class="stat-number">50K+</div>
        <div class="stat-label">Deliveries Made</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">180+</div>
        <div class="stat-label">Countries Covered</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">99.8%</div>
        <div class="stat-label">On-Time Rate</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-number">24/7</div>
        <div class="stat-label">Customer Support</div>
    </div>
</div>

<!-- Call to Action -->
<div class="cta-section">
    <div class="cta-content">
        <h2>Ready to Get Started?</h2>
        <p>Create your free account today and experience the future of logistics. Manage all your shipments from one convenient dashboard.</p>
        {% if not current_user.is_authenticated %}
        <a href="{{ url_for('users.register') }}" class="btn btn-primary" aria-label="Create a free account">
            <i class="fas fa-user-plus" aria-hidden="true"></i>
            <span>Create Free Account</span>
        </a>
        {% else %}
        <a href="{{ url_for('book_delivery') }}" class="btn btn-primary" aria-label="Create a new booking">
            <i class="fas fa-plus-circle" aria-hidden="true"></i>
            <span>Create New Booking</span>
        </a>
        {% endif %}
    </div>
</div>

<!-- Enhanced Mobile JavaScript - Fixed scrolling issue -->
<script>
    // Enhanced mobile interactions
    document.addEventListener('DOMContentLoaded', function() {
        // Touch device detection
        const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        
        if (isTouchDevice) {
            document.body.classList.add('touch-device');
            
            // Improve touch feedback for interactive elements
            const touchElements = document.querySelectorAll('.btn, .feature-card, .stat-card, .tracking-btn');
            
            touchElements.forEach(element => {
                element.addEventListener('touchstart', function() {
                    this.classList.add('touch-active');
                }, { passive: true });
                
                element.addEventListener('touchend', function() {
                    this.classList.remove('touch-active');
                }, { passive: true });
                
                element.addEventListener('touchcancel', function() {
                    this.classList.remove('touch-active');
                }, { passive: true });
            });
        }

        // Form validation enhancement
        const trackingForm = document.querySelector('.tracking-form');
        if (trackingForm) {
            trackingForm.addEventListener('submit', function(e) {
                const input = this.querySelector('.tracking-input');
                if (input && input.value.trim() === '') {
                    e.preventDefault();
                    input.focus();
                    input.classList.add('error');
                    setTimeout(() => input.classList.remove('error'), 300);
                }
            });
        }

        // Prevent zoom on input focus in iOS
        const inputs = document.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                if (window.innerWidth <= 768) {
                    this.style.fontSize = '16px'; // Prevent iOS zoom
                }
            });
            
            input.addEventListener('blur', function() {
                this.style.fontSize = '';
            });
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                const targetId = this.getAttribute('href');
                if (targetId !== '#') {
                    e.preventDefault();
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                }
            });
        });

        // Handle orientation change
        let resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function() {
                // Adjust layout for orientation changes
                if (window.innerWidth <= 768) {
                    document.body.classList.add('mobile-layout');
                } else {
                    document.body.classList.remove('mobile-layout');
                }
            }, 250);
        });

        // Load images lazily for better performance
        if ('IntersectionObserver' in window) {
            const lazyLoadObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const element = entry.target;
                        element.classList.add('visible');
                        
                        // If there's a background image to lazy load
                        const bgImage = element.getAttribute('data-bg');
                        if (bgImage) {
                            element.style.backgroundImage = `url(${bgImage})`;
                        }
                        
                        lazyLoadObserver.unobserve(element);
                    }
                });
            }, {
                rootMargin: '50px',
                threshold: 0.1
            });

            // Observe elements that should be lazy loaded
            document.querySelectorAll('.feature-card, .stat-card').forEach(el => {
                lazyLoadObserver.observe(el);
            });
        }

        // Handle keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // Close any open modals or dropdowns
                document.querySelectorAll('.active').forEach(el => {
                    el.classList.remove('active');
                });
            }
        });

        // REMOVED THE PROBLEMATIC PREVENT PULL-TO-REFRESH CODE
        // This was preventing scrolling on mobile
        
        // Instead, use a more targeted approach for preventing pull-to-refresh
        // only when absolutely necessary and not interfering with normal scrolling
        let startY = 0;
        
        document.addEventListener('touchstart', function(e) {
            startY = e.touches[0].pageY;
        }, { passive: true });
        
        document.addEventListener('touchmove', function(e) {
            // Only prevent if we're at the top of the page and user is pulling down
            if (window.scrollY <= 0) {
                const currentY = e.touches[0].pageY;
                
                // If pulling down more than 10px from the top
                if (currentY - startY > 10) {
                    e.preventDefault();
                    return false;
                }
            }
            
            // Allow all other touch movements
            return true;
        }, { passive: false });
    });
</script>
{% endblock %}